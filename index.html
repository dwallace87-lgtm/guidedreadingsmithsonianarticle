<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The True Native New Yorkers | Guided Reading</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet"/>
  <style>
    body { font-family: 'Lora', serif; }
    h1, h2, h3, h4, h5, h6 { font-family: 'Source Sans Pro', sans-serif; }
    :root { --blur: 7px; --speed: 220ms; --purple:#6D28D9; --purpleDark:#4C1D95; --ink:#111827; }
    .content { transition: filter var(--speed) ease; }
    .blurred .content,
    .blurred .gate {
      filter: blur(var(--blur));
      pointer-events: none; /* make blurred areas inert */
    }
    .visually-hidden { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }

    .nx-btn { border:1px solid var(--purpleDark); background:var(--purple); color:#fff; }
    .nx-btn:hover { background:var(--purpleDark); }

    /* Highlighter marks (pastels) */
    mark { padding: 0 .15em; border-radius: .2em; }
    .hl-blue   { background: #cfe8ff; }
    .hl-red    { background: #ffd6d6; }
    .hl-yellow { background: #fff4b8; }

    /* Swatch buttons */
    .swatch { width: 28px; height: 28px; border-radius: 999px; border: 2px solid rgba(0,0,0,.1); cursor: pointer; }
    .sw-blue   { background: #cfe8ff; }
    .sw-red    { background: #ffd6d6; }
    .sw-yellow { background: #fff4b8; }
    .sw-eraser { background: white; background-image: linear-gradient(135deg, transparent 45%, #e5e7eb 45%, #e5e7eb 55%, transparent 55%); }
    .is-active { outline: 2px solid #111827; outline-offset: 2px; }

    /* Keep selection enabled for highlighting; reduce touch callouts */
    * { -webkit-touch-callout: none; }
    #articleRoot { -webkit-user-select: text; user-select: text; }

    /* Logo + glint (non-blocking, respects reduced motion) */
    .logo-container { position: relative; overflow: hidden; cursor: pointer; display: inline-block; }
    .logo-container::after {
      content: "";
      position: absolute; inset: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.35), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s ease;
      pointer-events: none; /* don't steal clicks */
    }
    @media (prefers-reduced-motion: reduce) {
      .logo-container::after { transition: none; display: none; }
    }
    .logo-container:hover::after { transform: translateX(100%); }

    /* Toast */
    .toast {
      position: fixed;
      right: 1rem; bottom: 1rem;
      background: rgba(17,24,39,.95);
      color: #fff;
      padding: .5rem .75rem;
      border-radius: .5rem;
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
      font-size: .875rem;
      opacity: 0; transform: translateY(8px);
      transition: opacity .18s ease, transform .18s ease;
      pointer-events: none;
      z-index: 50;
    }
    .toast.show { opacity: 1; transform: translateY(0); }

    html[dir="rtl"] body { direction: rtl; }
    html[dir="rtl"] .prose { text-align: right; }

    /* —— Glossary ————————————————————————————————————— */
    .gloss {
      position: relative;
      cursor: help;
      padding: 0 .06em;
      border-bottom: 2px dotted rgba(109,40,217,.6);
      border-radius: .15rem;
    }
    .gloss:focus-visible {
      outline: 2px solid #6D28D9;
      outline-offset: 2px;
    }
    .gloss-bubble {
      position: fixed;
      max-width: min(32rem, 92vw);
      background: #111827;
      color: #fff;
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: 0 20px 40px rgba(0,0,0,.35);
      border-radius: .75rem;
      padding: .75rem .9rem;
      font-size: .94rem;
      line-height: 1.25rem;
      z-index: 60;
      opacity: 0;
      transform: translateY(6px) scale(.98);
      transition: opacity .15s ease, transform .15s ease;
    }
    .gloss-bubble.show {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    .gloss-bubble .term {
      display: inline-block;
      font-weight: 700;
      margin-right: .4rem;
    }
    .gloss-bubble .pron {
      display: inline-block;
      font-size: .85rem;
      margin-left: .25rem;
      color: rgba(255,255,255,.75);
      font-weight: 600;
    }
    .gloss-bubble .tone {
      opacity: .9;
    }
    .gloss-bubble .subtle {
      display: block;
      font-size: .8rem;
      opacity: .8;
      margin-top: .35rem;
    }

    .gloss-bubble::after {
      content: "";
      position: absolute;
      width: 10px; height: 10px;
      background: #111827;
      border-left: 1px solid rgba(255,255,255,.08);
      border-top: 1px solid rgba(255,255,255,.08);
      transform: rotate(45deg);
      left: 1rem; top: -5px;
    }
    @media (prefers-reduced-motion: reduce) {
      .gloss-bubble { transition: none; }
    }
  </style>
</head>
<body class="bg-gray-100">

  <section class="max-w-4xl mx-auto my-4 p-4 border rounded-lg bg-gray-50">
    <h4 id="t_studentInfo" class="font-semibold mb-2">Student Info</h4>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
      <label class="block text-sm" for="siName">
        <span id="t_nameLabel">Student Name (First Name, Last Name)</span>
        <input id="siName" class="mt-1 w-full border rounded p-2" placeholder="First Name, Last Name" />
      </label>
      <label class="block text-sm" for="siTimestamp">
        <span id="t_timeLabel">Timestamp (Eastern)</span>
        <input id="siTimestamp" class="mt-1 w-full border rounded p-2 bg-gray-100" aria-live="polite" readonly />
      </label>
      <label class="block text-sm" for="siPeriod">
        <span id="t_periodLabel">Period</span>
        <input id="siPeriod" class="mt-1 w-full border rounded p-2" placeholder="3" />
      </label>
    </div>
    <p id="t_savedNote" class="text-xs text-gray-600 mt-2">Saved on this Chromebook for next time.</p>
  </section>

  <!-- Northside header with logo + Highlighter tools -->
  <header class="bg-gradient-to-r from-purple-700 to-purple-900 text-white">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between gap-6 flex-wrap">
      <div class="flex items-center gap-4">
        <div class="logo-container rounded-md bg-white p-1 shadow-sm">
          <img src="https://northsidechs.org/wp-content/uploads/2023/03/northside-charter-logo-v.png"
               alt="Northside Charter High School logo" class="h-12 w-auto">
        </div>
        <h1 id="t_guidedReading" class="text-xl md:text-2xl font-semibold">Guided Reading Mode</h1>
      </div>

      <!-- Highlighter toolbar -->
      <div class="flex items-center gap-4 text-sm">
        <div class="flex items-center gap-3 text-sm" aria-label="Highlighter toolbar">
          <label class="flex items-center gap-2">
            <input id="hlToggle" type="checkbox" class="h-4 w-4" aria-checked="true">
            <span>Highlighter</span>
          </label>
          <button class="swatch sw-blue"   id="swBlue"   title="Blue (1)"   aria-label="Blue highlighter"   tabindex="0"></button>
          <button class="swatch sw-yellow" id="swYellow" title="Yellow (2)" aria-label="Yellow highlighter" tabindex="0"></button>
          <button class="swatch sw-red"    id="swRed"    title="Red (3)"    aria-label="Red highlighter"    tabindex="0"></button>
          <button class="swatch sw-eraser" id="swErase"  title="Eraser (4)" aria-label="Eraser"             tabindex="0"></button>
          <button id="clearHighlights" class="px-3 py-1 rounded-md border border-white/30 hover:bg-white/10">Clear highlights</button>
        </div>
        <!-- Language switcher -->
        <div class="flex items-center gap-2">
          <label for="langSelect" class="text-sm hidden sm:inline">Language</label>
          <select id="langSelect" class="px-2 py-1 rounded-md border text-gray-900">
            <option value="en">English</option>
            <option value="es">Español</option>
            <option value="ar">العربية</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <!-- Source masthead -->
  <div class="bg-black py-3">
    <img src="https://www.smithsonianmag.com/static/smithsonianmag/img/smithmag-logo-horizontal-white.98dddd9f3f4d.svg" alt="Smithsonian Magazine Logo" class="h-7 mx-auto">
  </div>

  <!-- Container -->
  <div class="bg-white max-w-4xl mx-auto my-8 p-4 sm:p-8 md:p-12 rounded-lg shadow-lg">

    <header class="border-b pb-6 mb-8">
      <h2 id="t_articleTitle" class="text-3xl md:text-5xl font-bold text-gray-900 leading-tight mb-4">
        The True Native New Yorkers Can Never Truly Reclaim Their Homeland
      </h2>
      <p id="t_articleDek" class="text-lg md:text-xl text-gray-600 font-light">
        Nearly 400 years after the famous story about the “sale of Manhattan,” some Lenape people are working to bring back their cultural heritage in the place their ancestors once lived.
      </p>
      <div class="mt-6 flex items-center">
        <img class="w-12 h-12 rounded-full mr-4" src="https://th-thumbnailer.cdn-si-edu.com/CLazphHVw0_coZSdkW88Xl2y4Zg=/fit-in/160x80/filters:no_upscale()/https://tf-cmsv2-smithsonianmag-media.s3.amazonaws.com/accounts/headshot/colleenc.png" alt="Colleen Connolly">
        <div>
          <p class="text-sm font-semibold text-gray-800">
            <span id="t_bylineName">Colleen Connolly</span> - <span id="t_bylineRole">Correspondent</span>
          </p>
          <p id="t_bylineDate" class="text-sm text-gray-500">October 5, 2018</p>
        </div>
      </div>

      <!-- Teacher control: Guided Reading is always ON -->
      <div class="mt-6 flex items-center justify-end gap-2">
        <button id="resetProgress" class="text-sm px-3 py-2 rounded-md border border-gray-300 hover:bg-gray-50">Reset Progress</button>
      </div>
      <p id="t_alwaysOn" class="text-xs text-gray-500 mt-2">Guided Reading is always on. Progress saves on this device.</p>
    </header>

    <!-- ARTICLE -->
    <article id="articleRoot" class="prose lg:prose-xl max-w-none text-gray-800">
      <figure class="mb-8">
        <img src="https://th-thumbnailer.cdn-si-edu.com/shQQP2jJJkYYHk7j_uFL6dZkUeY=/1026x684/https://tf-cmsv2-smithsonianmag-media.s3.amazonaws.com/filer/19/84/1984a5f2-122b-442f-9243-f2a2e3b123b0/img_9972_1.jpg" alt="Monument in lower Manhattan referencing a sale of Lenape lands" class="rounded-lg w-full">
        <figcaption id="t_fig1" class="text-center text-sm text-gray-600 mt-2">
          A monument in lower Manhattan commemorates the <strong>“sale” of Lenape lands</strong>.
        </figcaption>
      </figure>

      <!-- CHUNK 1 -->
      <section class="chunk" data-chunk="1" aria-labelledby="t_c1_title">
        <h3 id="t_c1_title" class="text-2xl font-bold">1) Early contact and a powerful myth</h3>
        <div class="content">
          <p id="t_c1_p1">When the <strong>Dutch</strong> first arrived in the 1600s, their interactions with the Native people, the <strong>Lenape</strong>, were mostly friendly. They traded goods and shared the land. A well-known story says the Dutch <strong>“purchased” Manahatta island in 1626</strong>. But this deal, and the wall the Dutch later built around their settlement of <strong>New Amsterdam</strong>, marked the start of the <strong>Lenape's forced migration</strong> away from their home.</p>
          <p id="t_c1_p2">That defensive wall later became the famous <strong>Wall Street</strong>. A Lenape path called <strong>Wickquasgeck</strong> became a Dutch road, which then became <strong>Broadway</strong>. The Lenape helped shape New York City's layout, but many other signs of their history have almost disappeared. Today, some Lenape are working to bring their heritage back to the city.</p>
        </div>

        <!-- Gate 1 -->
        <form class="gate mt-4 p-4 rounded-xl border border-gray-200 bg-gray-50" data-for="1" aria-describedby="t_c1_prompt" onsubmit="return false">
          <h4 id="t_c1_gateTitle" class="m-0 text-lg font-semibold">Historical Context</h4>
          <p id="t_c1_prompt" class="text-sm text-gray-600">The passage says a Lenape path became Broadway and a Dutch wall became Wall Street. What does this tell us about how New York City was built?</p>
          <fieldset class="mt-2">
            <legend class="visually-hidden">Context</legend>
            <label class="block my-1"><input type="radio" name="q1" value="a"> <span id="t_c1_a">The Dutch built their city completely separate from any Lenape settlements.</span></label>
            <label class="block my-1"><input type="radio" name="q1" value="b"> <span id="t_c1_b">The city grew on top of Lenape foundations, often replacing their history.</span></label>
            <label class="block my-1"><input type="radio" name="q1" value="c"> <span id="t_c1_c">The Lenape and the Dutch worked together as equal partners to plan the city.</span></label>
            <label class="block my-1"><input type="radio" name="q1" value="d"> <span id="t_c1_d">The original Lenape names for all major streets are still used in NYC today.</span></label>
          </fieldset>
          <button type="submit" class="nx-btn mt-2 px-3 py-2 rounded-md" id="t_checkBtn_1">Check</button>
          <p class="attempt-counter text-xs text-gray-500 mt-2" data-question="q1">
            <span id="t_attemptsLabel_1">Attempts:</span>
            <span class="attempt-count">0</span>
          </p>
          <div class="feedback mt-2 text-sm" role="status" aria-live="polite"></div>
        </form>
      </section>

      <!-- CHUNK 2 -->
      <section class="chunk blurred" data-chunk="2" aria-labelledby="t_c2_title" aria-hidden="true">
        <h3 id="t_c2_title" class="text-2xl font-bold">2) Lenape identity and homeland</h3>
        <div class="content">
          <p id="t_c2_p1">“We have a history there before the white man ever showed up, but the Lenape are forgotten because they haven’t had a presence there in centuries,” says <strong>Curtis Zunigha</strong>, a leader at the <strong>Lenape Center</strong> in Manhattan. The center works to support Lenape culture. Mr. Zunigha, however, lives in <strong>Oklahoma</strong>. This is because many Lenape were forced to move there long ago.</p>
          <p id="t_c2_p2">The original Lenape homeland, called <strong>Lenapehoking</strong>, was a large area that covered parts of modern-day New York, New Jersey, Pennsylvania, and Delaware. Today, the two U.S. tribes that are officially recognized by the government as Delaware (another name for the Lenape) are both located in Oklahoma.</p>
        </div>

        <!-- Gate 2 -->
        <form class="gate mt-4 p-4 rounded-xl border border-gray-200 bg-gray-50" data-for="2" aria-describedby="t_c2_prompt" onsubmit="return false">
          <h4 id="t_c2_gateTitle" class="m-0 text-lg font-semibold">Claim and Evidence</h4>
          <p id="t_c2_prompt" class="text-sm text-gray-600">Many Lenape people live far from NYC, but their connection to their homeland is still strong. Which piece of evidence best supports this claim?</p>
          <fieldset class="mt-2">
            <legend class="visually-hidden">Claim–Evidence</legend>
            <label class="block my-1"><input type="radio" name="q2" value="a"> <span id="t_c2_a">There are no people with any Lenape heritage still living in the New York area.</span></label>
            <label class="block my-1"><input type="radio" name="q2" value="b"> <span id="t_c2_b">The Lenape have forgotten all of their historical ties to the island of Manhattan.</span></label>
            <label class="block my-1"><input type="radio" name="q2" value="c"> <span id="t_c2_c">The Lenape Center, based in Manhattan, works to keep the culture alive today.</span></label>
            <label class="block my-1"><input type="radio" name="q2" value="d"> <span id="t_c2_d">Lenape leaders in Oklahoma have stated they have no interest in their history.</span></label>
          </fieldset>
          <button type="submit" class="nx-btn mt-2 px-3 py-2 rounded-md" id="t_checkBtn_2">Check</button>
          <p class="attempt-counter text-xs text-gray-500 mt-2" data-question="q2">
            <span id="t_attemptsLabel_2">Attempts:</span>
            <span class="attempt-count">0</span>
          </p>
          <div class="feedback mt-2 text-sm" role="status" aria-live="polite"></div>
        </form>
      </section>

      <!-- CHUNK 3 -->
      <section class="chunk blurred" data-chunk="3" aria-labelledby="t_c3_title" aria-hidden="true">
        <h3 id="t_c3_title" class="text-2xl font-bold">3) Migration routes and stigma</h3>
        <div class="content">
          <p id="t_c3_p1">The Lenape were pushed from their homeland over many years. They first moved to Pennsylvania, then Ohio and Indiana, then Missouri, and then Kansas. After the Civil War, the U.S. government forced the Lenape in Kansas to sell their land for railroad construction. They then moved to <strong>Oklahoma</strong>, where many live today.</p>
          <p id="t_c3_p2">Some Lenape people did remain in their original homeland. <strong>Margaret Boldeagle</strong>'s family is one example. She says that many families felt pressure to <strong>assimilate</strong>, or fit in with the new culture. She explains that because of discrimination, or unfair treatment, some people hid their Native identity. “Back in the day, there was a stigma to being native,” she says. “So, a lot of families did not admit to it.”</p>
        </div>

        <!-- Gate 3 -->
        <form class="gate mt-4 p-4 rounded-xl border border-gray-200 bg-gray-50" data-for="3" aria-describedby="t_c3_prompt" onsubmit="return false">
          <h4 id="t_c3_gateTitle" class="m-0 text-lg font-semibold">Cause and Effect</h4>
          <p id="t_c3_prompt" class="text-sm text-gray-600">The passage mentions a "stigma to being native." What was a direct result of this unfair treatment and the pressure people felt to assimilate?</p>
          <fieldset class="mt-2">
            <legend class="visually-hidden">Cause–Effect</legend>
            <label class="block my-1"><input type="radio" name="q3" value="a"> <span id="t_c3_a">The U.S. government celebrated and recognized all of the local Native tribes.</span></label>
            <label class="block my-1"><input type="radio" name="q3" value="b"> <span id="t_c3_b">It led to a great period of peace and shared cultural celebrations for all.</span></label>
            <label class="block my-1"><input type="radio" name="q3" value="c"> <span id="t_c3_c">Many Lenape families felt they had to hide their heritage to avoid mistreatment.</span></label>
            <label class="block my-1"><input type="radio" name="q3" value="d"> <span id="t_c3_d">European settlers started to adopt the traditional clothing of the Lenape people.</span></label>
          </fieldset>
          <button type="submit" class="nx-btn mt-2 px-3 py-2 rounded-md" id="t_checkBtn_3">Check</button>
          <p class="attempt-counter text-xs text-gray-500 mt-2" data-question="q3">
            <span id="t_attemptsLabel_3">Attempts:</span>
            <span class="attempt-count">0</span>
          </p>
          <div class="feedback mt-2 text-sm" role="status" aria-live="polite"></div>
        </form>
      </section>

      <!-- CHUNK 4 -->
      <section class="chunk blurred" data-chunk="4" aria-labelledby="t_c4_title" aria-hidden="true">
        <h3 id="t_c4_title" class="text-2xl font-bold">4) Monuments and the Manhattan story</h3>
        <div class="content">
          <p id="t_c4_p1">Today, two memorials in New York City mention the Lenape, but both tell a story that is not quite right. A monument in Battery Park and a plaque in Inwood Hill Park both commemorate the <strong>“sale of Manhattan,”</strong> continuing a myth that many experts say is a made-up story.</p>
          <p id="t_c4_p2">The plaque in Inwood Hill Park even claims the deal happened there, though it was more likely made at Fort Amsterdam in lower Manhattan. More importantly, experts say the Lenape probably saw the deal as an agreement to <strong>share the land</strong>, not to sell it forever. The Dutch, however, saw it as a final sale. Notes from a council meeting in 1660 show the Dutch were frustrated that the Lenape would not leave. The Lenape responded that they had only sold the grass, not the land itself.</p>
        </div>

        <!-- Gate 4 -->
        <form class="gate mt-4 p-4 rounded-xl border border-gray-200 bg-gray-50" data-for="4" aria-describedby="t_c4_prompt" onsubmit="return false">
          <h4 id="t_c4_gateTitle" class="m-0 text-lg font-semibold">Point of View</h4>
          <p id="t_c4_prompt" class="text-sm text-gray-600">The passage describes a major disagreement over the “sale of Manhattan.” What is the key difference between the Lenape and Dutch points of view?</p>
          <fieldset class="mt-2">
            <legend class="visually-hidden">POV</legend>
            <label class="block my-1"><input type="radio" name="q4" value="a"> <span id="t_c4_a">Both the Lenape and Dutch agreed the land would be returned after a few years.</span></label>
            <label class="block my-1"><input type="radio" name="q4" value="b"> <span id="t_c4_b">The Lenape wanted to sell the land, but the Dutch only wanted to rent it.</span></label>
            <label class="block my-1"><input type="radio" name="q4" value="c"> <span id="t_c4_c">The Dutch saw it as a one-time sale, while the Lenape saw it as a deal to share.</span></label>
            <label class="block my-1"><input type="radio" name="q4" value="d"> <span id="t_c4_d">The deal was only about trading furs and had nothing at all to do with the land.</span></label>
          </fieldset>
          <button type="submit" class="nx-btn mt-2 px-3 py-2 rounded-md" id="t_checkBtn_4">Check</button>
          <p class="attempt-counter text-xs text-gray-500 mt-2" data-question="q4">
            <span id="t_attemptsLabel_4">Attempts:</span>
            <span class="attempt-count">0</span>
          </p>
          <div class="feedback mt-2 text-sm" role="status" aria-live="polite"></div>
        </form>
      </section>

      <!-- Figure -->
      <figure class="my-8">
        <img src="https://th-thumbnailer.cdn-si-edu.com/Qll0z1MjUP0gwuED-nVqZXViXTY=/fit-in/1072x0/https://tf-cmsv2-smithsonianmag-media.s3.amazonaws.com/filer/2a/0e/2a0e65f8-bb9b-4b2d-b6ef-e9badec846ab/ap_091127023900.jpg" alt="Healing ceremony in 2009" class="rounded-lg w-full">
        <figcaption id="t_fig2" class="text-center text-sm text-gray-600 mt-2">
          A 2009 healing ceremony involving Lenape communities and the Collegiate Church.
        </figcaption>
      </figure>

      <!-- CHUNK 5 -->
      <section class="chunk blurred" data-chunk="5" aria-labelledby="t_c5_title" aria-hidden="true">
        <h3 id="t_c5_title" class="text-2xl font-bold">5) Language work and cultural continuity</h3>
        <div class="content">
          <p id="t_c5_p1">Even though monuments might tell an old story, Lenape culture remains alive today. In Oklahoma, the Delaware Tribe hosts camps for children to learn <strong>Lenape spiritual practices</strong>, songs, and dances. They have also worked hard to help save the endangered Lenape language, as there are very few fluent speakers left.</p>
          <p id="t_c5_p2"><strong>Jim Rementer</strong> has studied the language for over 50 years. He helped create the <strong>Lenape Talking Dictionary</strong>, which has online lessons with audio. While there are no native speakers in Oklahoma today, he says people are still very interested in learning. He explains that being able to use their native language in prayers and ceremonies helps connect them to their culture and ancestors, keeping it strong for the next generation.</p>
        </div>

        <!-- Gate 5 -->
        <form class="gate mt-4 p-4 rounded-xl border border-gray-200 bg-gray-50" data-for="5" aria-describedby="t_c5_prompt" onsubmit="return false">
          <h4 id="t_c5_gateTitle" class="m-0 text-lg font-semibold">Central Idea</h4>
          <p id="t_c5_prompt" class="text-sm text-gray-600">Despite being forced from their homes, the Lenape culture has survived. Which detail is the best proof of this cultural survival?</p>
          <fieldset class="mt-2">
            <legend class="visually-hidden">Central Idea</legend>
            <label class="block my-1"><input type="radio" name="q5" value="a"> <span id="t_c5_a">Modern monuments in NYC tell the complete and accurate history of the Lenape.</span></label>
            <label class="block my-1"><input type="radio" name="q5" value="b"> <span id="t_c5_b">The area around Wall Street is now a very important global financial center.</span></label>
            <label class="block my-1"><input type="radio" name="q5" value="c"> <span id="t_c5_c">The original Lenape paths are no longer visible anywhere in modern Manhattan.</span></label>
            <label class="block my-1"><input type="radio" name="q5" value="d"> <span id="t_c5_d">Cultural camps and the Lenape Talking Dictionary preserve traditions and language.</span></label>
          </fieldset>
          <button type="submit" class="nx-btn mt-2 px-3 py-2 rounded-md" id="t_checkBtn_5">Check</button>
          <p class="attempt-counter text-xs text-gray-500 mt-2" data-question="q5">
            <span id="t_attemptsLabel_5">Attempts:</span>
            <span class="attempt-count">0</span>
          </p>
          <div class="feedback mt-2 text-sm" role="status" aria-live="polite"></div>
        </form>
      </section>

      <p class="text-sm italic text-gray-600 mt-8">
        *Editor’s note, October 8, 2018: The <strong>Ramapough</strong> are recognized by New Jersey, not the state of Delaware.
      </p>
    </article>

    <section class="mt-12 p-6 sm:p-8 bg-purple-50 border border-purple-200 rounded-xl shadow-inner">
      <h3 id="t_refTitle" class="text-2xl font-bold text-purple-900">SEL Reflection &amp; R.A.C.E. Response</h3>
      <p id="t_refIntro1" class="mt-3 text-gray-800">
        Take a mindful pause to connect with the Lenape story and with your own community. Respond to the prompt below using the
        <strong>R.A.C.E. strategy</strong>—<strong>R</strong>estate the question, <strong>A</strong>nswer it clearly, <strong>C</strong>ite evidence from the article, and <strong>E</strong>xplain how that evidence shows your understanding and feelings.
      </p>
      <p id="t_refPrompt" class="mt-2 text-gray-700">
        Prompt: <em>How does learning about the Lenape people’s resilience and care for their homeland influence the way you support and empathize with others in your life?</em>
      </p>

      <form id="submissionForm" class="mt-4 space-y-4" novalidate>
        <label class="block">
          <span id="t_refFieldLabel" class="text-sm font-semibold text-gray-700">Write your R.A.C.E. paragraph below (no copy or paste allowed):</span>
          <textarea id="reflectionResponse" class="mt-2 w-full rounded-lg border border-purple-200 focus:border-purple-500 focus:ring-purple-500 p-3 shadow-sm" rows="8" placeholder="Restate the prompt, answer it, cite a specific detail from the article, and explain how it connects to your own actions." required></textarea>
        </label>
        <p id="t_typingOnly" class="text-xs text-gray-600">Typing only—pasting is disabled to make sure this is your own thinking.</p>
        <div class="flex items-center justify-between gap-4 flex-col sm:flex-row">
          <p id="t_savedMsg" class="text-sm text-gray-700">Your work stays saved on this Chromebook until you press Submit.</p>
          <div class="flex items-center gap-2">
            <button type="submit" class="nx-btn px-4 py-2 rounded-md shadow" id="t_submitAll">Submit All Work</button>
            <button type="button" id="pingEndpoint" class="px-3 py-1 rounded-md border border-gray-300 hover:bg-gray-50 text-sm">
              <span id="t_checkConn">Check connection</span>
            </button>
            <span id="pingStatus" class="text-sm ml-2"></span>
          </div>
        </div>
        <p id="submitStatus" class="text-sm" role="status" aria-live="polite"></p>
      </form>

      <div class="mt-8 space-y-4">
        <section class="p-5 rounded-xl bg-white border border-purple-200 shadow-sm">
          <h4 id="t_raceRemindTitle" class="text-lg font-semibold text-purple-900">R.A.C.E. Quick Reminder</h4>
          <p id="t_raceRemindP1" class="mt-2 text-sm text-gray-800">
            Start with <strong>one sentence</strong> that restates the prompt and gives your answer at the same time. Example: <em>"The question asks how teamwork helps our class, so teamwork helps because we share the jobs and cheer each other on."</em>
          </p>
          <p id="t_raceRemindP2" class="mt-2 text-sm text-gray-700">
            After that sentence, include evidence from the article and explain how it connects to your own actions or feelings.
          </p>
        </section>

        <section class="p-5 rounded-xl bg-white border border-purple-200 shadow-sm">
          <h4 id="t_raceRubricTitle" class="text-lg font-semibold text-purple-900">R.A.C.E. Paragraph Rubric</h4>
          <p id="t_raceRubricIntro" class="mt-2 text-sm text-gray-700">Check each box to make sure your paragraph shines.</p>
          <ul class="mt-4 space-y-3 text-sm text-gray-800">
            <li class="flex items-start gap-3">
              <span class="mt-1 h-3 w-3 rounded-full bg-green-400"></span>
              <span id="t_r1"><strong>Restate &amp; Answer:</strong> Open with the prompt in your own words and answer it clearly in the same sentence.</span>
            </li>
            <li class="flex items-start gap-3">
              <span class="mt-1 h-3 w-3 rounded-full bg-blue-400"></span>
              <span id="t_r2"><strong>Evidence:</strong> Include a specific fact or quote from the article to support your thinking.</span>
            </li>
            <li class="flex items-start gap-3">
              <span class="mt-1 h-3 w-3 rounded-full bg-purple-400"></span>
              <span id="t_r3"><strong>Explanation:</strong> Connect the evidence to your experiences, feelings, or actions.</span>
            </li>
            <li class="flex items-start gap-3">
              <span class="mt-1 h-3 w-3 rounded-full bg-yellow-400"></span>
              <span id="t_r4"><strong>Writing Moves:</strong> Use complete sentences, transition words, and a positive closing thought.</span>
            </li>
          </ul>
        </section>
      </div>
    </section>
  </div>

  <footer class="max-w-6xl mx-auto px-4 py-8 text-center text-sm text-gray-500">
    <span id="t_footer">© Northside Charter High School • U.S. History Regents Prep</span>
  </footer>

  <!-- Toast node -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    /* ========== Utility: Toast ========== */
    const toastEl = document.getElementById("toast");
    let toastTimer = null;
    function showToast(msg, ms=1500) {
      if (!toastEl) return;
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toastEl.classList.remove("show"), ms);
    }

    /* ========== Guided Reading (always ON) ========== */
    const article = document.getElementById("articleRoot");
    const KEY = "lenape-guided-reading-progress-v3";
    const ENDPOINT_URL = "https://formspree.io/f/mvgwnvjk";
    const ASSIGNMENT_NAME = "1021 Native American Article";
    const HEADER_KEYS = [
      "submission_id","submitted_at_iso","submitted_at_et","student_name","period",
      "device_id","assignment",
      "q1_attempts","q2_attempts","q3_attempts","q4_attempts","q5_attempts",
      "q1_correct","q2_correct","q3_correct","q4_correct","q5_correct",
      "chunks_completed","total_attempts","score_correct","score_percent",
      "reflection_words","reflection_chars","reflection_text"
    ];
    const DEVICE_ID_STORAGE_KEY = "lenape-guided-reading-device-id";
    const SUBMISSION_PREFIX = "LENAPE";
    const ANSWERS = { q1: "b", q2: "c", q3: "c", q4: "c", q5: "d" };
    const HL_KEY = "lenape-article-highlights-v2"; // defined ONCE and reused

    // Restore saved highlights BEFORE we query .chunk nodes or wire listeners
    const savedArticle = localStorage.getItem(HL_KEY);
    if (savedArticle) article.innerHTML = savedArticle;

    const chunks = Array.from(document.querySelectorAll(".chunk"));
    const resetBtn = document.getElementById("resetProgress");

    const progress = JSON.parse(localStorage.getItem(KEY) || "{}");

    function ensureProgressStructures() {
      if (!progress || typeof progress !== "object") return;
      if (!progress.attempts || typeof progress.attempts !== "object") progress.attempts = {};
      if (!progress.responses || typeof progress.responses !== "object") progress.responses = {};
      if (!progress.profile || typeof progress.profile !== "object") progress.profile = {};
    }

    ensureProgressStructures();

    function saveProgress() {
      ensureProgressStructures();
      localStorage.setItem(KEY, JSON.stringify(progress));
    }

    const studentNameInput = document.getElementById("siName");
    const studentPeriodInput = document.getElementById("siPeriod");
    const timestampInput = document.getElementById("siTimestamp");

    let profileAdjusted = false;
    if (progress.profile?.studentEmail) {
      delete progress.profile.studentEmail;
      profileAdjusted = true;
    }
    if (progress.profile?.classPeriod) {
      if (!progress.profile.period) {
        progress.profile.period = progress.profile.classPeriod;
      }
      delete progress.profile.classPeriod;
      profileAdjusted = true;
    }
    if (profileAdjusted) saveProgress();

    function updateProfileField(key, value) {
      if (!progress.profile) return;
      const clean = typeof value === "string" ? value.trim() : "";
      if (clean) {
        progress.profile[key] = clean;
      } else {
        delete progress.profile[key];
      }
      saveProgress();
    }

    if (studentNameInput) {
      studentNameInput.value = progress.profile.studentName || "";
      studentNameInput.addEventListener("input", () => {
        updateProfileField("studentName", studentNameInput.value);
      });
    }

    if (studentPeriodInput) {
      studentPeriodInput.value = progress.profile.period || "";
      studentPeriodInput.addEventListener("input", () => {
        updateProfileField("period", studentPeriodInput.value);
      });
    }

    const easternFormatter = new Intl.DateTimeFormat("en-US", {
      timeZone: "America/New_York",
      year: "numeric",
      month: "2-digit",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      hour12: true
    });

    function formatEasternTimestamp(date) {
      const parts = easternFormatter.formatToParts(date).reduce((acc, part) => {
        if (part.type !== "literal") acc[part.type] = part.value;
        return acc;
      }, {});
      const dayPeriod = parts.dayPeriod ? ` ${parts.dayPeriod}` : "";
      return `${parts.year}-${parts.month}-${parts.day} ${parts.hour}:${parts.minute}${dayPeriod} ET`;
    }

    function refreshEasternTimestamp() {
      if (!timestampInput) return;
      const now = new Date();
      const display = formatEasternTimestamp(now);
      if (timestampInput.value !== display) {
        timestampInput.value = display;
      }
      if (progress.profile.timestampEastern !== display) {
        progress.profile.timestampEastern = display;
        progress.profile.timestampISO = now.toISOString();
        saveProgress();
      }
    }

    if (timestampInput) {
      refreshEasternTimestamp();
      setInterval(refreshEasternTimestamp, 15000);
    }

    ensureIdentifiers();

    function ensureIdentifiers() {
      let updated = false;
      if (!progress.deviceId) {
        progress.deviceId = getOrCreateDeviceId();
        updated = true;
      } else {
        localStorage.setItem(DEVICE_ID_STORAGE_KEY, progress.deviceId);
      }
      if (!progress.submissionId) {
        progress.submissionId = createSubmissionId();
        updated = true;
      }
      if (updated) saveProgress();
    }

    function getOrCreateDeviceId() {
      const stored = localStorage.getItem(DEVICE_ID_STORAGE_KEY);
      if (stored) return stored;
      const random = Math.random().toString(36).toUpperCase().replace(/[^A-Z0-9]/g, "");
      const fragment = random.slice(-4).padStart(4, "0");
      const id = `CB-${fragment}`;
      localStorage.setItem(DEVICE_ID_STORAGE_KEY, id);
      return id;
    }

    function createSubmissionId() {
      const now = new Date();
      const stamp = `${now.getUTCFullYear()}${String(now.getUTCMonth() + 1).padStart(2, "0")}${String(now.getUTCDate()).padStart(2, "0")}` +
        `${String(now.getUTCHours()).padStart(2, "0")}${String(now.getUTCMinutes()).padStart(2, "0")}${String(now.getUTCSeconds()).padStart(2, "0")}`;
      const random = Math.random().toString(36).slice(-4).toUpperCase();
      return `${SUBMISSION_PREFIX}-${stamp}-${random}`;
    }

    function countWords(text) {
      if (!text) return 0;
      return text.trim().split(/\s+/).filter(Boolean).length;
    }

    function buildSubmissionRow(currentProgress, reflectionText) {
      const profile = currentProgress?.profile || {};
      const attempts = currentProgress?.attempts || {};

      // Attempts per question
      const a1 = Number(attempts.q1 || 0);
      const a2 = Number(attempts.q2 || 0);
      const a3 = Number(attempts.q3 || 0);
      const a4 = Number(attempts.q4 || 0);
      const a5 = Number(attempts.q5 || 0);

      // A chunk is correct when it is marked true in progress
      const c1 = Boolean(currentProgress[1] === true);
      const c2 = Boolean(currentProgress[2] === true);
      const c3 = Boolean(currentProgress[3] === true);
      const c4 = Boolean(currentProgress[4] === true);
      const c5 = Boolean(currentProgress[5] === true);

      const chunksCompleted = [c1,c2,c3,c4,c5].filter(Boolean).length;
      const totalAttempts = a1 + a2 + a3 + a4 + a5;
      const scoreCorrect = chunksCompleted;
      const scorePercent = Math.round((scoreCorrect / 5) * 100);

      const response = typeof reflectionText === "string" ? reflectionText : "";
      const reflectionWords = countWords(response);
      const reflectionChars = response.length;

      const submissionId = currentProgress?.submissionId || createSubmissionId();
      const submittedAtISO = currentProgress?.submittedAt || new Date().toISOString();
      const deviceId = currentProgress?.deviceId || getOrCreateDeviceId();

      if (!currentProgress.submissionId) currentProgress.submissionId = submissionId;
      if (!currentProgress.deviceId) currentProgress.deviceId = deviceId;

      // This is already maintained by your clock code
      const submittedAtET = profile.timestampEastern || "";

      // Order must match your Google Sheet header
      return [
        submissionId,                  // submission_id
        submittedAtISO,                // submitted_at_iso
        submittedAtET,                 // submitted_at_et
        profile.studentName || "",     // student_name
        profile.period || "",          // period
        deviceId,                      // device_id
        profile.assignmentName || ASSIGNMENT_NAME, // assignment
        a1,a2,a3,a4,a5,                // q*_attempts
        c1,c2,c3,c4,c5,                // q*_correct
        chunksCompleted,               // chunks_completed
        totalAttempts,                 // total_attempts
        scoreCorrect,                  // score_correct
        scorePercent,                  // score_percent
        reflectionWords,               // reflection_words
        reflectionChars,               // reflection_chars
        response                       // reflection_text
      ];
    }

    // ---- Send to Formspree instead of Google Sheets ----
    async function postToFormspree(row) {
      // Turn the row array into a named object using your header keys
      const payload = Object.fromEntries(HEADER_KEYS.map((k, i) => [k, row[i] ?? ""]));

      try {
        const res = await fetch(ENDPOINT_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Accept": "application/json"    // <-- important for Formspree CORS
          },
          body: JSON.stringify(payload)
        });
        return res.ok;
      } catch (err) {
        console.warn("Formspree error:", err);
        return false;
      }
    }

    const reflectionForm = document.getElementById("submissionForm");
    const reflectionField = document.getElementById("reflectionResponse");
    const submitButton = document.getElementById("t_submitAll");

    function setSubmissionLocked(isLocked) {
      if (reflectionField) {
        reflectionField.readOnly = isLocked;
        reflectionField.classList.toggle("bg-gray-100", isLocked);
      }
      if (submitButton) {
        submitButton.disabled = isLocked;
        submitButton.classList.toggle("opacity-50", isLocked);
        submitButton.classList.toggle("cursor-not-allowed", isLocked);
      }
      if (reflectionForm) {
        if (isLocked) {
          reflectionForm.setAttribute("aria-disabled", "true");
        } else {
          reflectionForm.removeAttribute("aria-disabled");
        }
      }
    }
    const submitStatus = document.getElementById("submitStatus");

    function updateAttemptCounters() {
      document.querySelectorAll('.gate').forEach(gate => {
        const qKey = "q" + gate.dataset.for;
        const counter = gate.querySelector('.attempt-counter');
        if (!counter) return;
        const count = Number(progress.attempts?.[qKey] || 0);
        let countSpan = counter.querySelector('.attempt-count');
        if (!countSpan) {
          countSpan = document.createElement('span');
          countSpan.className = 'attempt-count';
          const labelSpan = counter.querySelector('[id^="t_attemptsLabel_"]');
          if (labelSpan) {
            labelSpan.insertAdjacentText('afterend', ' ');
            labelSpan.insertAdjacentElement('afterend', countSpan);
          } else {
            counter.appendChild(countSpan);
          }
        }
        countSpan.textContent = String(count);
      });
    }

    function applyBlurFromProgress() {
      chunks.forEach(section => {
        const n = Number(section.dataset.chunk);
        const content = section.querySelector('.content');
        const gate = section.querySelector('.gate');

        if (n === 1 || progress[n - 1] === true) {
          section.classList.remove("blurred");
          section.removeAttribute("aria-hidden");
          content && content.classList.remove("blurred");
          gate && gate.classList.remove("blurred");
        } else {
          section.classList.add("blurred");
          section.setAttribute("aria-hidden", "true");
          content && content.classList.add("blurred");
          gate && gate.classList.add("blurred");
        }
      });
    }

    function revealChunk(num, move) {
      const next = document.querySelector(`.chunk[data-chunk="${num}"]`);
      if (!next) return;
      next.classList.remove("blurred");
      next.removeAttribute("aria-hidden");
      const nextContent = next.querySelector('.content');
      const nextGate = next.querySelector('.gate');
      nextContent && nextContent.classList.remove("blurred");
      nextGate && nextGate.classList.remove("blurred");
      if (move) next.scrollIntoView({ behavior: "smooth", block: "start" });
    }

    applyBlurFromProgress();
    updateAttemptCounters();

    // Gate checks (event delegation)
    article.addEventListener("submit", (e) => {
      if (!e.target.matches('.gate')) return;
      e.preventDefault();

      const gate = e.target;
      const chunk = Number(gate.dataset.for);
      const fd = new FormData(gate);
      const chosen = fd.get("q" + chunk);
      const feedback = gate.querySelector(".feedback");
      const qKey = "q" + chunk;

      if (!chosen) {
        feedback.textContent = "Pick an answer.";
        feedback.className = "feedback mt-2 text-sm text-red-600";
        return;
      }

      progress.attempts[qKey] = (progress.attempts[qKey] || 0) + 1;
      saveProgress();
      updateAttemptCounters();

      if (chosen === ANSWERS[qKey]) {
        feedback.textContent = chunk < chunks.length ? "Correct. Continue." : "Complete. Nice work.";
        feedback.className = "feedback mt-2 text-sm text-green-700";
        progress[chunk] = true;
        saveProgress();
        revealChunk(chunk + 1, true);
      } else {
        feedback.textContent = "Not correct. Try again.";
        feedback.className = "feedback mt-2 text-sm text-red-600";
      }
    });

    // Reset progress
    resetBtn?.addEventListener("click", () => {
      if (progress.submittedAt) {
        showToast("Submission already sent from this device.");
        if (submitStatus) {
          const submittedDate = new Date(progress.submittedAt);
          submitStatus.textContent = `Already submitted on ${submittedDate.toLocaleString()}. Further submissions from this device are locked.`;
          submitStatus.className = "text-sm text-green-700";
        }
        setSubmissionLocked(true);
        return;
      }
      localStorage.removeItem(KEY);
      for (const k in progress) delete progress[k];
      ensureProgressStructures();
      if (studentNameInput) studentNameInput.value = "";
      if (studentPeriodInput) studentPeriodInput.value = "";
      if (timestampInput) refreshEasternTimestamp();
      saveProgress();
      document.querySelectorAll(".gate .feedback").forEach(el => el.textContent = "");
      document.querySelectorAll('.attempt-counter .attempt-count').forEach(span => {
        span.textContent = '0';
      });
      if (reflectionField) reflectionField.value = "";
      if (submitStatus) {
        submitStatus.textContent = "";
        submitStatus.className = "text-sm";
      }
      setSubmissionLocked(false);
      window.scrollTo({ top: 0, behavior: "smooth" });
      applyBlurFromProgress();
      updateAttemptCounters();
    });

    if (reflectionField) {
      reflectionField.value = progress.responses.reflection || "";
      reflectionField.addEventListener("input", () => {
        progress.responses.reflection = reflectionField.value;
        saveProgress();
      });
      const blockPaste = (e) => {
        e.preventDefault();
        showToast("Typing only—pasting is disabled.");
      };
      reflectionField.addEventListener("paste", blockPaste);
      reflectionField.addEventListener("drop", blockPaste);
      reflectionField.addEventListener("copy", (e) => {
        e.preventDefault();
        showToast("Copying from this field is disabled. Use your own words!");
      });
    }

    const alreadySubmitted = Boolean(progress.submittedAt);
    setSubmissionLocked(alreadySubmitted);

    if (submitStatus && alreadySubmitted) {
      const submittedDate = new Date(progress.submittedAt);
      submitStatus.textContent = `Submitted on ${submittedDate.toLocaleString()}. Further submissions from this device are locked.`;
      submitStatus.className = "text-sm text-green-700";
    }

    reflectionForm?.addEventListener("submit", (e) => {
      e.preventDefault();
      if (progress.submittedAt) {
        if (submitStatus) {
          const submittedDate = new Date(progress.submittedAt);
          submitStatus.textContent = `Already submitted on ${submittedDate.toLocaleString()}. Further submissions from this device are locked.`;
          submitStatus.className = "text-sm text-green-700";
        }
        showToast("Already submitted from this device.");
        setSubmissionLocked(true);
        return;
      }
      const responseText = reflectionField?.value.trim() || "";
      if (!responseText) {
        if (submitStatus) {
          submitStatus.textContent = "Please complete your R.A.C.E. paragraph before submitting.";
          submitStatus.className = "text-sm text-red-600";
        }
        reflectionField?.focus();
        return;
      }

      progress.responses.reflection = responseText;
      progress.submittedAt = new Date().toISOString();
      saveProgress();
      setSubmissionLocked(true);

      const completion = chunks.reduce((acc, section) => {
        const n = Number(section.dataset.chunk);
        acc[`chunk${n}`] = Boolean(progress[n]);
        return acc;
      }, {});

      const submissionPayload = {
        attempts: { ...progress.attempts },
        completion,
        reflection: responseText,
        submittedAt: progress.submittedAt
      };

      console.info("Guided reading submission", submissionPayload);

      if (submitStatus) {
        submitStatus.textContent = "Submitting to teacher sheet...";
        submitStatus.className = "text-sm text-gray-700";
      }
      showToast("Submission saved!");

      const csvRow = buildSubmissionRow(progress, responseText);
      postToFormspree(csvRow).then(ok => {
        if (ok) {
          showToast("Sent to Formspree");
          if (submitStatus) {
            submitStatus.textContent = "Submitted and recorded (Formspree). Further submissions from this device are locked.";
            submitStatus.className = "text-sm text-green-700";
          }
        } else {
          showToast("Could not reach Formspree. Saved locally.");
          if (submitStatus) {
            submitStatus.textContent = "Saved locally on this device. Please show your teacher; submissions are locked.";
            submitStatus.className = "text-sm text-yellow-700";
          }
        }
      }).catch(err => {
        console.error("Formspree submit error", err);
        showToast("Could not reach Formspree. Saved locally.");
        if (submitStatus) {
          submitStatus.textContent = "Saved locally on this device. Please show your teacher; submissions are locked.";
          submitStatus.className = "text-sm text-yellow-700";
        }
      });
    });

    document.getElementById("pingEndpoint")?.addEventListener("click", () => {
      const status = document.getElementById("pingStatus");
      status.textContent = "Pinging…";

      // Minimal row that still matches your header order
      postToFormspree([
        `PING-${Date.now()}`,                     // submission_id
        new Date().toISOString(),                // submitted_at_iso
        progress.profile?.timestampEastern || "",// submitted_at_et
        progress.profile?.studentName || "",     // student_name
        progress.profile?.period || "",          // period
        progress.deviceId || getOrCreateDeviceId(), // device_id
        ASSIGNMENT_NAME,                         // assignment
        0,0,0,0,0,                                // q*_attempts
        false,false,false,false,false,            // q*_correct
        0,0,0,0,                                  // chunks/attempts/score/percent
        0,0,                                      // reflection_words/chars
        "ping"                                    // reflection_text
      ])
      .then(ok => { status.textContent = ok ? "Connected" : "No response"; })
      .catch(() => { status.textContent = "Error"; });
    });

    /* ========== Teacher Unlock: hold Shift+L for 3s ========== */
    let unlockHoldTimer = null;
    let unlockAutoTimer = null;
    let isUnlocked = false;
    const UNLOCK_HOLD_MS = 3000;
    const UNLOCK_WINDOW_MS = 60000;

    function unlockAll() {
      isUnlocked = true;
      chunks.forEach(sec => {
        sec.classList.remove("blurred");
        sec.removeAttribute("aria-hidden");
        sec.querySelector('.content')?.classList.remove("blurred");
        sec.querySelector('.gate')?.classList.remove("blurred");
      });
    }
    function relockAll() {
      isUnlocked = false;
      applyBlurFromProgress();
    }

    document.addEventListener("keydown", (e) => {
      if (!(e.shiftKey && (e.key === "L" || e.key === "l"))) return;

      // If already unlocked, pressing again relocks immediately
      if (isUnlocked) {
        clearTimeout(unlockHoldTimer);
        clearTimeout(unlockAutoTimer);
        relockAll();
        showToast("Guided reading relocked.");
        return;
      }

      if (unlockHoldTimer) return; // already counting
      unlockHoldTimer = setTimeout(() => {
        unlockHoldTimer = null;
        unlockAll();
        showToast("Guided reading unlocked for 60s.");
        clearTimeout(unlockAutoTimer);
        unlockAutoTimer = setTimeout(() => {
          relockAll();
          showToast("Guided reading relocked.");
        }, UNLOCK_WINDOW_MS);
      }, UNLOCK_HOLD_MS);
    });

    document.addEventListener("keyup", (e) => {
      if (e.key === "L" || e.key === "l") {
        clearTimeout(unlockHoldTimer);
        unlockHoldTimer = null;
      }
    });

    /* ========== Highlighter ========== */
    const hlToggle = document.getElementById("hlToggle");
    const swBlue   = document.getElementById("swBlue");
    const swYellow = document.getElementById("swYellow");
    const swRed    = document.getElementById("swRed");
    const swErase  = document.getElementById("swErase");
    const clearBtn = document.getElementById("clearHighlights");

    let hlEnabled = true;
    let hlMode = "yellow";

    if (hlToggle) { hlToggle.checked = true; hlToggle.setAttribute("aria-checked","true"); }

    function setActiveSwatch(btn) {
      [swBlue, swYellow, swRed, swErase].forEach(b => b.classList.remove("is-active"));
      btn && btn.classList.add("is-active");
    }
    setActiveSwatch(swYellow);

    hlToggle?.addEventListener("change", () => {
      hlEnabled = hlToggle.checked;
      hlToggle.setAttribute("aria-checked", String(hlEnabled));
      if (!hlEnabled) {
        hlMode = null;
        setActiveSwatch(null);
        document.body.style.cursor = "auto";
      } else {
        hlMode = hlMode || "yellow";
        setActiveSwatch(hlMode === "yellow" ? swYellow : hlMode === "blue" ? swBlue : hlMode === "red" ? swRed : swErase);
        document.body.style.cursor = hlMode === "erase" ? "not-allowed" : "text";
      }
    });

    function pickMode(mode, btn) {
      if (!hlEnabled) { hlToggle.checked = true; hlToggle.dispatchEvent(new Event("change")); }
      hlMode = mode;
      setActiveSwatch(btn);
      document.body.style.cursor = mode === "erase" ? "not-allowed" : "text";
    }
    swBlue?.addEventListener("click",  () => pickMode("blue", swBlue));
    swYellow?.addEventListener("click",() => pickMode("yellow", swYellow));
    swRed?.addEventListener("click",   () => pickMode("red", swRed));
    swErase?.addEventListener("click", () => pickMode("erase", swErase));

    // Keyboard shortcuts: 1=Blue, 2=Yellow, 3=Red, 4=Eraser
    document.addEventListener("keydown", (e) => {
      if (e.target && /input|textarea|select/i.test(e.target.tagName)) return;
      if (e.key === "1") pickMode("blue", swBlue);
      else if (e.key === "2") pickMode("yellow", swYellow);
      else if (e.key === "3") pickMode("red", swRed);
      else if (e.key === "4") pickMode("erase", swErase);
    });

    function selectionTouchesGate(range) {
      const start = range.startContainer.nodeType === 1 ? range.startContainer : range.startContainer.parentNode;
      const end   = range.endContainer.nodeType === 1 ? range.endContainer : range.endContainer.parentNode;
      return (start.closest && start.closest(".gate")) || (end.closest && end.closest(".gate"));
    }

    function wrapSelection(range, className) {
      const mark = document.createElement("mark");
      mark.className = className;
      const frag = range.cloneContents();
      if (frag.querySelector && frag.querySelector(".gate")) return;
      range.deleteContents();
      mark.appendChild(frag);
      range.insertNode(mark);
      mark.parentNode?.normalize();
    }

    function highlightSelection(color) {
      const sel = window.getSelection();
      if (!sel || sel.isCollapsed || sel.rangeCount === 0) return false;
      const range = sel.getRangeAt(0);
      const node = range.commonAncestorContainer.nodeType === 1 ? range.commonAncestorContainer : range.commonAncestorContainer.parentNode;
      if (!article.contains(node) || selectionTouchesGate(range)) return false;

      try {
        const mark = document.createElement("mark");
        mark.className = "hl-" + color;
        range.surroundContents(mark);
        mark.parentNode?.normalize();
      } catch {
        wrapSelection(range, "hl-" + color);
      }
      sel.removeAllRanges();
      return true;
    }

    // Eraser (delegated)
    article.addEventListener("click", (e) => {
      if (!hlEnabled || hlMode !== "erase") return;
      const t = e.target;
      if (t.tagName === "MARK") {
        const parent = t.parentNode;
        while (t.firstChild) parent.insertBefore(t.firstChild, t);
        parent.removeChild(t);
        parent.normalize();
        localStorage.setItem(HL_KEY, article.innerHTML);
      }
    });

    // Apply highlight on mouseup inside article
    article.addEventListener("mouseup", () => {
      if (!hlEnabled || !hlMode || hlMode === "erase") return;
      if (highlightSelection(hlMode)) {
        localStorage.setItem(HL_KEY, article.innerHTML);
      }
    });

    // Clear all highlights
    function clearAllHighlights() {
      article.querySelectorAll("mark").forEach(m => {
        const parent = m.parentNode;
        while (m.firstChild) parent.insertBefore(m.firstChild, m);
        parent.removeChild(m);
        parent.normalize();
      });
      localStorage.removeItem(HL_KEY);
    }
    clearBtn?.addEventListener("click", clearAllHighlights);

    /* ========== Anti-copy protections + toast ========== */
    document.addEventListener("contextmenu", (e) => {
      if (!e.shiftKey) { e.preventDefault(); showToast("Copy disabled"); }
    });
    document.addEventListener("copy", (e) => {
      e.preventDefault();
      e.clipboardData?.setData("text/plain","");
      showToast("Copy disabled");
    });
    document.addEventListener("cut",  (e) => { e.preventDefault(); showToast("Copy disabled"); });
    document.addEventListener("keydown", (e) => {
      const k = e.key.toLowerCase();
      const meta = e.ctrlKey || e.metaKey;
      if (meta && (k === "c" || k === "x" || k === "s" || (k === "u" && !e.shiftKey))) {
        e.preventDefault();
        showToast("Copy disabled");
      }
    });
  </script>

  <script>
  /* —— GLOSSARY: edit freely (Brooklyn-teacher tone, classroom-clean) ——— */
  const GLOSSARY = {
    "Lenape": {
      pron: "/leh-NAH-pay/",
      def: "The Native nation whose homeland included NYC before Europeans showed up. Think: the original New Yorkers."
    },
    "Manahatta": {
      pron: "/man-uh-HAT-uh/",
      def: "Old Lenape name for the island—yep, that’s Manhattan before it was Manhattan."
    },
    "New Amsterdam": {
      pron: "/noo AM-stur-dam/",
      def: "The Dutch version of NYC before it got the name New York."
    },
    "forced migration": {
      pron: "/forst mye-GRAY-shun/",
      def: "People pushed to move—not a road trip, more like ‘you gotta go or else.’"
    },
    "Wickquasgeck": {
      pron: "/wick-KWAH-sheck/",
      def: "Lenape footpath that basically became Broadway. The city is built on older routes."
    },
    "treaties": {
      pron: "/TREE-teez/",
      def: "Official agreements between groups or governments—on paper, with rules (even if they weren’t respected)."
    },
    "federally recognized": {
      pron: "/FED-ur-uh-lee REK-ug-nized/",
      def: "The U.S. government officially says ‘this is a tribe.’ That status affects rights and resources."
    },
    "assimilate": {
      pron: "/uh-SIM-uh-late/",
      def: "Blend into the majority culture—act, dress, and talk like them to be accepted."
    },
    "stigma": {
      pron: "/STIG-muh/",
      def: "A social mark—people judge you for it, so folks hide parts of themselves."
    },
    "memorial": {
      pron: "/muh-MOR-ee-uhl/",
      def: "A structure meant to honor history, but it can still tell the story wrong."
    },
    "inaccuracies": {
      pron: "/in-AK-yuh-ruh-seez/",
      def: "Parts that aren’t correct—history can get messy or biased."
    },
    "perpetuating": {
      pron: "/per-PETCH-oo-ay-ting/",
      def: "Keeping a story going—true or not—by repeating it."
    },
    "fabrication": {
      pron: "/fab-ri-KAY-shun/",
      def: "A made-up piece—something that sounds real but isn’t."
    },
    "plaque": {
      pron: "/plak/",
      def: "A metal sign on a wall or rock that ‘explains’ history in like three sentences."
    },
    "council": {
      pron: "/KOWN-suhl/",
      def: "Leaders meeting to make decisions—like a city board back then."
    },
    "indigenous": {
      pron: "/in-DI-jen-us/",
      def: "The people native to a place—the first communities there."
    },
    "heritage": {
      pron: "/HAIR-uh-tij/",
      def: "What gets passed down—culture, language, traditions, stories."
    },
    "cultural continuity": {
      pron: "/KUL-chuh-rul kon-tin-NOO-uh-tee/",
      def: "Keeping cultural practices, beliefs, and community ties flowing from one generation to the next."
    },
    "descendants": {
      pron: "/dih-SEND-ents/",
      def: "Kids of kids of kids—future generations in a family or people."
    },
    "shared use": {
      pron: "/SHARED yoos/",
      def: "We can both use this land—doesn’t mean ‘we sold it forever.’"
    },
    "Lenapehoking": {
      pron: "/leh-NAH-pay-HO-king/",
      def: "The Lenape homeland—NY, NJ, parts of PA and DE. Big area, not just Manhattan."
    },
    "spiritual practices": {
      pron: "/SPIR-ih-choo-uhl PRAK-tis-iz/",
      def: "Ways people connect with the sacred—ceremony, song, prayer."
    },
    "ceremonies": {
      pron: "/SARE-uh-moh-neez/",
      def: "Organized traditions to honor people, the land, and ancestors."
    },
    "discrimination": {
      pron: "/dis-krim-uh-NAY-shun/",
      def: "Unfair treatment of people because of who they are—race, culture, language, or identity."
    },
    "endangered (language)": {
      pron: "/en-DANE-jerd/",
      def: "Not many speakers left—if folks don’t learn it, it could fade out."
    },
    "endangered": {
      pron: "/en-DANE-jerd/",
      def: "At serious risk of being lost—like a species, culture, or language on the brink."
    },
    "dictionary (Lenape Talking Dictionary)": {
      pron: "/DIK-shuh-ner-ee/",
      def: "Online tool with words + audio, to keep language alive."
    }
  };

  /* —— which words to tag (include common variants & capitalization) —— */
  const GLOSSARY_MAP = Object.fromEntries(
    Object.entries(GLOSSARY).map(([term, entry]) => [term.toLowerCase(), entry])
  );
  const GLOSSARY_TERMS = Object.keys(GLOSSARY_MAP);

  /* —— annotate: wrap matches in <span class="gloss" tabindex="0"> —— */
  function annotateGlossary(root) {
    const skipSel = new Set(["SCRIPT","STYLE","CODE","KBD","SAMP","BUTTON","INPUT","TEXTAREA","SELECT"]);
    const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, {
      acceptNode(node) {
        if (!node.nodeValue || !node.nodeValue.trim()) return NodeFilter.FILTER_REJECT;
        const p = node.parentElement;
        if (!p) return NodeFilter.FILTER_REJECT;
        if (skipSel.has(p.tagName)) return NodeFilter.FILTER_REJECT;
        if (p.closest(".gate")) return NodeFilter.FILTER_REJECT;
        if (p.closest(".gloss")) return NodeFilter.FILTER_REJECT;
        return NodeFilter.FILTER_ACCEPT;
      }
    });

    const escaped = GLOSSARY_TERMS
      .sort((a,b)=>b.length-a.length)
      .map(t => t.replace(/[-/\\^$*+?.()|[\]{}]/g, "\\$&"));
    const re = new RegExp("\\b(" + escaped.join("|") + ")\\b", "gi");

    const nodes = [];
    while (walker.nextNode()) nodes.push(walker.currentNode);

    nodes.forEach(textNode => {
      const txt = textNode.nodeValue;
      re.lastIndex = 0;
      if (!re.test(txt)) return;
      re.lastIndex = 0;

      const frag = document.createDocumentFragment();
      let lastIdx = 0;
      txt.replace(re, (match, term, idx) => {
        if (idx > lastIdx) frag.appendChild(document.createTextNode(txt.slice(lastIdx, idx)));
        const span = document.createElement("span");
        span.className = "gloss";
        span.tabIndex = 0;
        const key = (term || match).toLowerCase();
        span.dataset.term = match;
        span.dataset.key = key;
        span.textContent = match;
        frag.appendChild(span);
        lastIdx = idx + match.length;
        return match;
      });
      if (lastIdx < txt.length) frag.appendChild(document.createTextNode(txt.slice(lastIdx)));
      textNode.parentNode.replaceChild(frag, textNode);
    });
  }

  /* —— bubble: single global popover we reuse —— */
  let glossBubble;
  let activeGloss = null;
  function ensureBubble() {
    if (glossBubble) return glossBubble;
    glossBubble = document.createElement("div");
    glossBubble.className = "gloss-bubble";
    glossBubble.setAttribute("role", "dialog");
    glossBubble.setAttribute("aria-modal", "false");
    glossBubble.style.display = "none";
    document.body.appendChild(glossBubble);
    return glossBubble;
  }
  function hideBubble() {
    if (!glossBubble) return;
    glossBubble.classList.remove("show");
    setTimeout(() => { glossBubble && (glossBubble.style.display = "none"); }, 150);
    activeGloss = null;
  }
  function showBubbleFor(el) {
    const key = (el.dataset.key || el.textContent || "").toLowerCase();
    const entry = GLOSSARY_MAP[key];
    if (!entry) return hideBubble();
    const { def, pron } = entry;

    const bubble = ensureBubble();
    bubble.innerHTML = `
      <span class="term">${el.dataset.term || key}</span>
      ${pron ? `<span class="pron">${pron}</span>` : ""}
      <span class="tone">${def}</span>
      <span class="subtle">Tap word again or press Esc to dismiss.</span>
    `;

    const r = el.getBoundingClientRect();
    bubble.style.display = "block";
    const after = bubble.getBoundingClientRect();
    let top = Math.max(8, r.bottom + 8);
    let left = Math.max(8, Math.min(window.innerWidth - after.width - 8, r.left));

    bubble.style.top = `${top}px`;
    bubble.style.left = `${left}px`;
    bubble.classList.add("show");
    activeGloss = el;
  }

  function isGloss(el){ return el && el.classList && el.classList.contains("gloss"); }

  document.addEventListener("click", (e) => {
    const t = e.target;
    if (isGloss(t)) {
      if (activeGloss === t && glossBubble && glossBubble.style.display === "block") {
        hideBubble();
      } else {
        showBubbleFor(t);
      }
    } else if (glossBubble && !glossBubble.contains(t)) {
      hideBubble();
    }
  });
  document.addEventListener("keydown", (e) => {
    if (isGloss(document.activeElement) && (e.key === "Enter" || e.key === " ")) {
      e.preventDefault();
      showBubbleFor(document.activeElement);
    }
    if (e.key === "Escape") hideBubble();
  });
  window.addEventListener("scroll", () => hideBubble());
  window.addEventListener("resize", () => hideBubble());

  (function initGlossary(){
    const article = document.getElementById("articleRoot");
    if (!article) return;
    annotateGlossary(article);
  })();
  </script>

  <script>
  /* ========= i18n translations ========= */
  const I18N = {
    en: {
      t_studentInfo: "Student Info",
      t_nameLabel: "Student Name (First Name, Last Name)",
      t_timeLabel: "Timestamp (Eastern)",
      t_periodLabel: "Period",
      t_savedNote: "Saved on this Chromebook for next time.",
      t_guidedReading: "Guided Reading Mode",
      t_alwaysOn: "Guided Reading is always on. Progress saves on this device.",
      t_articleTitle: "The True Native New Yorkers Can Never Truly Reclaim Their Homeland",
      t_articleDek:
        "Nearly 400 years after the famous story about the “sale of Manhattan,” some Lenape people are working to bring back their cultural heritage in the place their ancestors once lived.",
      t_bylineName: "Colleen Connolly",
      t_bylineRole: "Correspondent",
      t_bylineDate: "October 5, 2018",
      t_fig1: 'A monument in lower Manhattan commemorates the <strong>“sale” of Lenape lands</strong>.',
      t_c1_title: "1) Early contact and a powerful myth",
      t_c1_p1:
        'When the <strong>Dutch</strong> first arrived in the 1600s, their interactions with the Native people, the <strong>Lenape</strong>, were mostly friendly. They traded goods and shared the land. A well-known story says the Dutch <strong>“purchased” Manahatta island in 1626</strong>. But this deal, and the wall the Dutch later built around their settlement of <strong>New Amsterdam</strong>, marked the start of the <strong>Lenape\'s forced migration</strong> away from their home.',
      t_c1_p2:
        'That defensive wall later became the famous <strong>Wall Street</strong>. A Lenape path called <strong>Wickquasgeck</strong> became a Dutch road, which then became <strong>Broadway</strong>. The Lenape helped shape New York City\'s layout, but many other signs of their history have almost disappeared. Today, some Lenape are working to bring their heritage back to the city.',
      t_c1_gateTitle: "Historical Context",
      t_c1_prompt:
        "The passage says a Lenape path became Broadway and a Dutch wall became Wall Street. What does this tell us about how New York City was built?",
      t_c1_a: "The Dutch built their city completely separate from any Lenape settlements.",
      t_c1_b: "The city grew on top of Lenape foundations, often replacing their history.",
      t_c1_c: "The Lenape and the Dutch worked together as equal partners to plan the city.",
      t_c1_d: "The original Lenape names for all major streets are still used in NYC today.",
      t_fig2: "A 2009 healing ceremony involving Lenape communities and the Collegiate Church.",
      t_c2_title: "2) Lenape identity and homeland",
      t_c2_p1:
        "“We have a history there before the white man ever showed up, but the Lenape are forgotten because they haven’t had a presence there in centuries,” says <strong>Curtis Zunigha</strong>, a leader at the <strong>Lenape Center</strong> in Manhattan. The center works to support Lenape culture. Mr. Zunigha, however, lives in <strong>Oklahoma</strong>. This is because many Lenape were forced to move there long ago.",
      t_c2_p2:
        "The original Lenape homeland, called <strong>Lenapehoking</strong>, was a large area that covered parts of modern-day New York, New Jersey, Pennsylvania, and Delaware. Today, the two U.S. tribes that are officially recognized by the government as Delaware (another name for the Lenape) are both located in Oklahoma.",
      t_c2_gateTitle: "Claim and Evidence",
      t_c2_prompt:
        "Many Lenape people live far from NYC, but their connection to their homeland is still strong. Which piece of evidence best supports this claim?",
      t_c2_a: "There are no people with any Lenape heritage still living in the New York area.",
      t_c2_b: "The Lenape have forgotten all of their historical ties to the island of Manhattan.",
      t_c2_c: "The Lenape Center, based in Manhattan, works to keep the culture alive today.",
      t_c2_d: "Lenape leaders in Oklahoma have stated they have no interest in their history.",
      t_c3_title: "3) Migration routes and stigma",
      t_c3_p1:
        "The Lenape were pushed from their homeland over many years. They first moved to Pennsylvania, then Ohio and Indiana, then Missouri, and then Kansas. After the Civil War, the U.S. government forced the Lenape in Kansas to sell their land for railroad construction. They then moved to <strong>Oklahoma</strong>, where many live today.",
      t_c3_p2:
        "Some Lenape people did remain in their original homeland. <strong>Margaret Boldeagle</strong>'s family is one example. She says that many families felt pressure to <strong>assimilate</strong>, or fit in with the new culture. She explains that because of discrimination, or unfair treatment, some people hid their Native identity. “Back in the day, there was a stigma to being native,” she says. “So, a lot of families did not admit to it.”",
      t_c3_gateTitle: "Cause and Effect",
      t_c3_prompt:
        'The passage mentions a "stigma to being native." What was a direct result of this unfair treatment and the pressure people felt to assimilate?',
      t_c3_a: "The U.S. government celebrated and recognized all of the local Native tribes.",
      t_c3_b: "It led to a great period of peace and shared cultural celebrations for all.",
      t_c3_c: "Many Lenape families felt they had to hide their heritage to avoid mistreatment.",
      t_c3_d: "European settlers started to adopt the traditional clothing of the Lenape people.",
      t_c4_title: "4) Monuments and the Manhattan story",
      t_c4_p1:
        "Today, two memorials in New York City mention the Lenape, but both tell a story that is not quite right. A monument in Battery Park and a plaque in Inwood Hill Park both commemorate the <strong>“sale of Manhattan,”</strong> continuing a myth that many experts say is a made-up story.",
      t_c4_p2:
        "The plaque in Inwood Hill Park even claims the deal happened there, though it was more likely made at Fort Amsterdam in lower Manhattan. More importantly, experts say the Lenape probably saw the deal as an agreement to <strong>share the land</strong>, not to sell it forever. The Dutch, however, saw it as a final sale. Notes from a council meeting in 1660 show the Dutch were frustrated that the Lenape would not leave. The Lenape responded that they had only sold the grass, not the land itself.",
      t_c4_gateTitle: "Point of View",
      t_c4_prompt:
        "The passage describes a major disagreement over the “sale of Manhattan.” What is the key difference between the Lenape and Dutch points of view?",
      t_c4_a: "Both the Lenape and Dutch agreed the land would be returned after a few years.",
      t_c4_b: "The Lenape wanted to sell the land, but the Dutch only wanted to rent it.",
      t_c4_c: "The Dutch saw it as a one-time sale, while the Lenape saw it as a deal to share.",
      t_c4_d: "The deal was only about trading furs and had nothing at all to do with the land.",
      t_c5_title: "5) Language work and cultural continuity",
      t_c5_p1:
        "Even though monuments might tell an old story, Lenape culture remains alive today. In Oklahoma, the Delaware Tribe hosts camps for children to learn <strong>Lenape spiritual practices</strong>, songs, and dances. They have also worked hard to help save the endangered Lenape language, as there are very few fluent speakers left.",
      t_c5_p2:
        "<strong>Jim Rementer</strong> has studied the language for over 50 years. He helped create the <strong>Lenape Talking Dictionary</strong>, which has online lessons with audio. While there are no native speakers in Oklahoma today, he says people are still very interested in learning. He explains that being able to use their native language in prayers and ceremonies helps connect them to their culture and ancestors, keeping it strong for the next generation.",
      t_c5_gateTitle: "Central Idea",
      t_c5_prompt:
        "Despite being forced from their homes, the Lenape culture has survived. Which detail is the best proof of this cultural survival?",
      t_c5_a: "Modern monuments in NYC tell the complete and accurate history of the Lenape.",
      t_c5_b: "The area around Wall Street is now a very important global financial center.",
      t_c5_c: "The original Lenape paths are no longer visible anywhere in modern Manhattan.",
      t_c5_d: "Cultural camps and the Lenape Talking Dictionary preserve traditions and language.",
      t_fig2: "A 2009 healing ceremony involving Lenape communities and the Collegiate Church.",
      t_refTitle: "SEL Reflection & R.A.C.E. Response",
      t_refIntro1:
        "Take a mindful pause to connect with the Lenape story and with your own community. Respond to the prompt below using the <strong>R.A.C.E. strategy</strong> — <strong>R</strong>estate the question, <strong>A</strong>nswer it clearly, <strong>C</strong>ite evidence from the article, and <strong>E</strong>xplain how that evidence shows your understanding and feelings.",
      t_refPrompt:
        "Prompt: <em>How does learning about the Lenape people’s resilience and care for their homeland influence the way you support and empathize with others in your life?</em>",
      t_refFieldLabel: "Write your R.A.C.E. paragraph below (no copy or paste allowed):",
      t_typingOnly: "Typing only. Pasting is disabled to make sure this is your own thinking.",
      t_savedMsg: "Your work stays saved on this Chromebook until you press Submit.",
      t_submitAll: "Submit All Work",
      t_checkConn: "Check connection",
      t_raceRemindTitle: "R.A.C.E. Quick Reminder",
      t_raceRemindP1:
        'Start with <strong>one sentence</strong> that restates the prompt and gives your answer at the same time. Example: <em>"The question asks how teamwork helps our class, so teamwork helps because we share the jobs and cheer each other on."</em>',
      t_raceRemindP2:
        "After that sentence, include evidence from the article and explain how it connects to your own actions or feelings.",
      t_raceRubricTitle: "R.A.C.E. Paragraph Rubric",
      t_raceRubricIntro: "Check each box to make sure your paragraph shines.",
      t_r1: "<strong>Restate & Answer:</strong> Open with the prompt in your own words and answer it clearly in the same sentence.",
      t_r2: "<strong>Evidence:</strong> Include a specific fact or quote from the article to support your thinking.",
      t_r3: "<strong>Explanation:</strong> Connect the evidence to your experiences, feelings, or actions.",
      t_r4: "<strong>Writing Moves:</strong> Use complete sentences, transition words, and a positive closing thought.",
      t_footer: "© Northside Charter High School • U.S. History Regents Prep",
      // per-chunk buttons/labels
      t_checkBtn_1: "Check", t_attemptsLabel_1: "Attempts:",
      t_checkBtn_2: "Check", t_attemptsLabel_2: "Attempts:",
      t_checkBtn_3: "Check", t_attemptsLabel_3: "Attempts:",
      t_checkBtn_4: "Check", t_attemptsLabel_4: "Attempts:",
      t_checkBtn_5: "Check", t_attemptsLabel_5: "Attempts:"
    },

    es: {
      t_studentInfo: "Información del estudiante",
      t_nameLabel: "Nombre del estudiante (Nombre, Apellido)",
      t_timeLabel: "Hora (Este)",
      t_periodLabel: "Periodo",
      t_savedNote: "Guardado en este Chromebook para la próxima vez.",
      t_guidedReading: "Modo de lectura guiada",
      t_alwaysOn: "La lectura guiada está siempre activada. El progreso se guarda en este dispositivo.",
      t_articleTitle: "Los verdaderos nativos neoyorquinos no pueden recuperar por completo su tierra",
      t_articleDek:
        "Casi 400 años después de la famosa historia sobre la “venta de Manhattan”, algunas personas lenape trabajan para recuperar su patrimonio cultural en el lugar donde vivieron sus antepasados.",
      t_bylineName: "Colleen Connolly",
      t_bylineRole: "Corresponsal",
      t_bylineDate: "5 de octubre de 2018",
      t_fig1: 'Un monumento en el bajo Manhattan conmemora la <strong>“venta” de tierras lenape</strong>.',
      t_c1_title: "1) Primeros contactos y un mito poderoso",
      t_c1_p1:
        "Cuando llegaron los <strong>holandeses</strong> en el siglo XVII, sus interacciones con los <strong>lenape</strong> fueron en su mayoría amistosas. Intercambiaban bienes y compartían la tierra. Una historia conocida dice que los holandeses <strong>“compraron” la isla de Manahatta en 1626</strong>. Pero ese trato, y el muro que luego construyeron alrededor de <strong>Nueva Ámsterdam</strong>, marcó el inicio de la <strong>migración forzada</strong> de los lenape lejos de su hogar.",
      t_c1_p2:
        "Aquel muro defensivo se convirtió después en la famosa <strong>Wall Street</strong>. Un camino lenape llamado <strong>Wickquasgeck</strong> se volvió una carretera holandesa y luego <strong>Broadway</strong>. Los lenape ayudaron a dar forma al trazado de la ciudad de Nueva York, pero muchas otras huellas de su historia casi han desaparecido. Hoy, algunos lenape trabajan para devolver su herencia a la ciudad.",
      t_c1_gateTitle: "Contexto histórico",
      t_c1_prompt:
        "El texto dice que un sendero lenape se convirtió en Broadway y un muro holandés en Wall Street. ¿Qué nos dice esto sobre cómo se construyó Nueva York?",
      t_c1_a: "Los holandeses construyeron su ciudad completamente separada de los asentamientos lenape.",
      t_c1_b: "La ciudad creció sobre bases lenape, a menudo sustituyendo su historia.",
      t_c1_c: "Los lenape y los holandeses planificaron la ciudad como socios iguales.",
      t_c1_d: "Los nombres lenape originales de todas las calles principales se siguen usando en la actualidad.",
      t_fig2: "Ceremonia de sanación en 2009 entre comunidades lenape y la Collegiate Church.",
      t_c2_title: "2) Identidad lenape y territorio",
      t_c2_p1:
        "“Tenemos una historia allí antes de que llegara el hombre blanco, pero los lenape han sido olvidados porque no han tenido presencia allí durante siglos”, dice <strong>Curtis Zunigha</strong>, líder del <strong>Lenape Center</strong> en Manhattan. El centro apoya la cultura lenape. Sin embargo, el Sr. Zunigha vive en <strong>Oklahoma</strong>, porque muchos lenape fueron obligados a mudarse allí hace mucho.",
      t_c2_p2:
        "El territorio original lenape, llamado <strong>Lenapehoking</strong>, abarcaba partes de la actual Nueva York, Nueva Jersey, Pensilvania y Delaware. Hoy, las dos tribus reconocidas oficialmente por el gobierno como Delaware (otro nombre para los lenape) están en Oklahoma.",
      t_c2_gateTitle: "Afirmación y evidencia",
      t_c2_prompt:
        "Muchos lenape viven lejos de NYC, pero su vínculo con su territorio sigue siendo fuerte. ¿Qué evidencia apoya mejor esta afirmación?",
      t_c2_a: "No queda nadie con herencia lenape viviendo en el área de Nueva York.",
      t_c2_b: "Los lenape han olvidado todos sus lazos históricos con la isla de Manhattan.",
      t_c2_c: "El Lenape Center, con sede en Manhattan, trabaja para mantener viva la cultura hoy.",
      t_c2_d: "Líderes lenape en Oklahoma han dicho que no les interesa su historia.",
      t_c3_title: "3) Rutas de migración y estigma",
      t_c3_p1:
        "Los lenape fueron expulsados de su territorio a lo largo de muchos años. Primero se mudaron a Pensilvania, luego a Ohio e Indiana, después a Misuri y luego a Kansas. Tras la Guerra Civil, el gobierno de Estados Unidos obligó a los lenape en Kansas a vender su tierra para construir el ferrocarril. Luego se trasladaron a <strong>Oklahoma</strong>, donde muchos viven hoy.",
      t_c3_p2:
        "Algunas personas lenape sí permanecieron en su territorio original. La familia de <strong>Margaret Boldeagle</strong> es un ejemplo. Ella dice que muchas familias sintieron presión para <strong>asimilarse</strong>, es decir, encajar en la nueva cultura. Explica que por la <strong>discriminación</strong> algunas personas ocultaron su identidad nativa. “Antes, había un estigma por ser nativo”, dice. “Así que muchas familias no lo admitían”.",
      t_c3_gateTitle: "Causa y efecto",
      t_c3_prompt:
        "El texto menciona un “estigma por ser nativo”. ¿Cuál fue un resultado directo de ese trato injusto y de la presión por asimilarse?",
      t_c3_a: "El gobierno de EE. UU. celebró y reconoció a todas las tribus locales.",
      t_c3_b: "Provocó un gran período de paz y celebraciones culturales compartidas para todos.",
      t_c3_c: "Muchas familias lenape ocultaron su herencia para evitar el maltrato.",
      t_c3_d: "Los colonos europeos empezaron a adoptar la ropa tradicional lenape.",
      t_c4_title: "4) Monumentos y la historia de Manhattan",
      t_c4_p1:
        "Hoy hay dos memoriales en la ciudad de Nueva York que mencionan a los lenape, pero ambos cuentan una historia que no es del todo correcta. Un monumento en Battery Park y una placa en Inwood Hill Park conmemoran la <strong>“venta de Manhattan”</strong>, perpetuando un mito que muchos expertos consideran inventado.",
      t_c4_p2:
        "La placa en Inwood Hill Park incluso afirma que el trato ocurrió allí, aunque probablemente se cerró en el Fuerte Ámsterdam, en el bajo Manhattan. Lo más importante: expertos sostienen que los lenape vieron el acuerdo como <strong>uso compartido</strong> de la tierra, no como venta definitiva. Los holandeses lo vieron como venta final. Actas de 1660 muestran que los holandeses estaban frustrados porque los lenape no se iban. Los lenape respondieron que solo habían vendido la hierba, no la tierra.",
      t_c4_gateTitle: "Punto de vista",
      t_c4_prompt:
        "El texto describe un gran desacuerdo sobre la “venta de Manhattan”. ¿Cuál es la diferencia clave entre los puntos de vista lenape y holandés?",
      t_c4_a: "Ambos acordaron devolver la tierra después de algunos años.",
      t_c4_b: "Los lenape querían vender la tierra, pero los holandeses solo querían arrendarla.",
      t_c4_c: "Los holandeses lo vieron como venta única; los lenape como acuerdo para compartir.",
      t_c4_d: "El trato solo trataba de pieles y no tenía nada que ver con la tierra.",
      t_c5_title: "5) Lengua y continuidad cultural",
      t_c5_p1:
        "Aunque los monumentos cuenten una historia antigua, la cultura lenape sigue viva hoy. En Oklahoma, la Tribu Delaware organiza campamentos para que los niños aprendan <strong>prácticas espirituales lenape</strong>, cantos y danzas. También han trabajado para salvar la lengua lenape, que está en peligro porque hay pocos hablantes fluidos.",
      t_c5_p2:
        "<strong>Jim Rementer</strong> ha estudiado la lengua por más de 50 años. Ayudó a crear el <strong>Lenape Talking Dictionary</strong>, con lecciones y audio en línea. Aunque hoy no hay hablantes nativos en Oklahoma, dice que la gente sigue interesada en aprender. Explica que usar su lengua en oraciones y ceremonias conecta a la comunidad con su cultura y sus ancestros, y la mantiene fuerte para la próxima generación.",
      t_c5_gateTitle: "Idea central",
      t_c5_prompt:
        "A pesar de haber sido expulsados de su hogar, la cultura lenape ha sobrevivido. ¿Qué detalle prueba mejor esta continuidad cultural?",
      t_c5_a: "Los monumentos modernos de NYC cuentan toda la historia lenape con precisión.",
      t_c5_b: "El área de Wall Street ahora es un centro financiero global muy importante.",
      t_c5_c: "Los caminos lenape originales ya no se ven en ningún lugar de Manhattan.",
      t_c5_d: "Los campamentos culturales y el Lenape Talking Dictionary preservan tradiciones y lengua.",
      t_refTitle: "Reflexión SEL y respuesta R.A.C.E.",
      t_refIntro1:
        "Haz una pausa consciente para conectar con la historia lenape y con tu comunidad. Responde usando la <strong>estrategia R.A.C.E.</strong>: <strong>R</strong>epite la pregunta, <strong>A</strong>nswer/Responde con claridad, <strong>C</strong>ita evidencia del artículo y <strong>E</strong>xplícalo.",
      t_refPrompt:
        "Consigna: <em>¿Cómo influye aprender sobre la resiliencia de los lenape y su cuidado por la tierra en la forma en que apoyas y empatizas con otros en tu vida?</em>",
      t_refFieldLabel: "Escribe tu párrafo R.A.C.E. (no se permite pegar):",
      t_typingOnly: "Solo escribir. Pegar está deshabilitado para asegurar que sea tu propio pensamiento.",
      t_savedMsg: "Tu trabajo se guarda en este Chromebook hasta que envíes.",
      t_submitAll: "Enviar todo",
      t_checkConn: "Comprobar conexión",
      t_raceRemindTitle: "Recordatorio rápido de R.A.C.E.",
      t_raceRemindP1:
        'Empieza con <strong>una oración</strong> que repita la consigna y dé tu respuesta. Ejemplo: <em>"La pregunta pide cómo ayuda el trabajo en equipo, y ayuda porque compartimos tareas y nos animamos".</em>',
      t_raceRemindP2:
        "Después, incluye evidencia del artículo y explica cómo se conecta con tus acciones o sentimientos.",
      t_raceRubricTitle: "Rúbrica del párrafo R.A.C.E.",
      t_raceRubricIntro: "Marca cada casilla para que tu párrafo destaque.",
      t_r1: "<strong>Repite y responde:</strong> Abre con la consigna en tus palabras y responde claro en esa misma oración.",
      t_r2: "<strong>Evidencia:</strong> Incluye un dato o cita concreta del artículo.",
      t_r3: "<strong>Explicación:</strong> Conecta la evidencia con tus experiencias, sentimientos o acciones.",
      t_r4: "<strong>Escritura:</strong> Usa oraciones completas, conectores y un cierre positivo.",
      t_footer: "© Northside Charter High School • Preparación para Regents de Historia de EE. UU.",
      t_checkBtn_1: "Revisar", t_attemptsLabel_1: "Intentos:",
      t_checkBtn_2: "Revisar", t_attemptsLabel_2: "Intentos:",
      t_checkBtn_3: "Revisar", t_attemptsLabel_3: "Intentos:",
      t_checkBtn_4: "Revisar", t_attemptsLabel_4: "Intentos:",
      t_checkBtn_5: "Revisar", t_attemptsLabel_5: "Intentos:"
    },

    ar: {
      t_studentInfo: "معلومات الطالب",
      t_nameLabel: "اسم الطالب (الاسم الأول، اسم العائلة)",
      t_timeLabel: "التوقيت (الساحل الشرقي)",
      t_periodLabel: "الحصة",
      t_savedNote: "يُحفَظ التقدم على هذا الـ Chromebook للاستخدام لاحقًا.",
      t_guidedReading: "وضع القراءة الموجَّهة",
      t_alwaysOn: "القراءة الموجَّهة مفعّلة دائمًا. يتم حفظ التقدم على هذا الجهاز.",
      t_articleTitle: "السكان الأصليون الحقيقيون لمدينة نيويورك لا يستطيعون استعادة وطنهم بالكامل",
      t_articleDek:
        "بعد ما يقرب من 400 عام على قصة “بيع مانهاتن”، يعمل بعض شعب اللينابي على استعادة تراثهم الثقافي في المكان الذي عاش فيه أسلافهم.",
      t_bylineName: "كولين كونولي",
      t_bylineRole: "مراسلة",
      t_bylineDate: "5 أكتوبر 2018",
      t_fig1: 'نُصُب في جنوب مانهاتن يخلّد <strong>“بيع” أراضي اللينابي</strong>.',
      t_c1_title: "1) اتصال مبكر وأسطورة قوية",
      t_c1_p1:
        "عندما وصل <strong>الهولنديون</strong> في القرن السابع عشر، كانت معاملاتهم مع السكان الأصليين <strong>اللينابي</strong> ودّية في الغالب. تبادلوا السلع وتقاسموا الأرض. وتقول قصة معروفة إن الهولنديين <strong>“اشتروا” جزيرة مناهاتا عام 1626</strong>. لكن ذلك الاتفاق، والجدار الذي بناه الهولنديون لاحقًا حول <strong>نيو أمستردام</strong>، كان بداية <strong>التهجير القسري</strong> للينابي عن وطنهم.",
      t_c1_p2:
        "صار ذلك الجدار الدفاعي لاحقًا <strong>وول ستريت</strong> الشهيرة. ومسار لينابي اسمه <strong>ويككواسجيك</strong> صار طريقًا هولنديًا ثم <strong>برودواي</strong>. ساهم اللينابي في تخطيط مدينة نيويورك، لكن كثيرًا من آثار تاريخهم اختفى تقريبًا. واليوم يعمل بعضهم على إعادة تراثهم إلى المدينة.",
      t_c1_gateTitle: "السياق التاريخي",
      t_c1_prompt:
        "يذكر النص أن مسارًا لينابي أصبح برودواي وأن جدارًا هولنديًا أصبح وول ستريت. ماذا يخبرنا هذا عن كيفية بناء نيويورك؟",
      t_c1_a: "بنى الهولنديون مدينتهم منفصلة تمامًا عن أي تجمعات للينابي.",
      t_c1_b: "نمت المدينة فوق أسس لينابية، وغالبًا ما استبدلت تاريخهم.",
      t_c1_c: "خطط اللينابي والهولنديون المدينة معًا كشركاء متساوين.",
      t_c1_d: "ما زالت الأسماء اللينابية الأصلية لجميع الشوارع الرئيسية مستخدمة حتى اليوم.",
      t_fig2: "مراسم شفاء عام 2009 بين مجتمعات اللينابي وكنيسة Collegiate.",
      t_c2_title: "2) هوية اللينابي ووطنهم",
      t_c2_p1:
        "يقول <strong>كيرتِس زونيغا</strong>، وهو قائد في <strong>مركز اللينابي</strong> بمانهاتن: “لدينا تاريخ هناك قبل وصول الرجل الأبيض، لكن تم نسيان اللينابي لأن وجودهم انقطع منذ قرون”. يعمل المركز على دعم ثقافة اللينابي. إلا أن زونيغا يعيش في <strong>أوكلاهوما</strong> لأن الكثير من اللينابي أُجبروا على الانتقال إلى هناك منذ زمن.",
      t_c2_p2:
        "كان وطن اللينابي الأصلي، <strong>لينابيهُوكينغ</strong>، منطقة واسعة تضم أجزاء من نيويورك ونيوجيرسي وبنسلفانيا وديلاوير. واليوم تقع القبيلتان المعترف بهما رسميًا باسم “ديلاوير” في أوكلاهوما.",
      t_c2_gateTitle: "الادعاء والدليل",
      t_c2_prompt:
        "يعيش كثير من اللينابي بعيدًا عن نيويورك، لكن ارتباطهم بوطنهم ما يزال قويًا. أي دليل يدعم هذا الادعاء أفضل دعم؟",
      t_c2_a: "لا يوجد أحد من ذوي الأصل اللينابي يعيش في منطقة نيويورك.",
      t_c2_b: "نسي اللينابي كل صلاتهم التاريخية بجزيرة مانهاتن.",
      t_c2_c: "يعمل مركز اللينابي في مانهاتن اليوم على إبقاء الثقافة حيّة.",
      t_c2_d: "صرّح قادة لينابي في أوكلاهوما بعدم اهتمامهم بتاريخهم.",
      t_c3_title: "3) مسارات الهجرة والوصم",
      t_c3_p1:
        "دُفع اللينابي بعيدًا عن وطنهم عبر سنوات طويلة. انتقلوا أولًا إلى بنسلفانيا، ثم أوهايو وإنديانا، ثم ميزوري، ثم كانساس. بعد الحرب الأهلية، أجبرت الحكومة الأميركية اللينابي في كانساس على بيع أرضهم لبناء السكك الحديدية، ثم انتقلوا إلى <strong>أوكلاهوما</strong> حيث يعيش كثيرون اليوم.",
      t_c3_p2:
        "بقي بعض اللينابي في موطنهم الأصلي. عائلة <strong>مارغريت بولديغل</strong> مثال على ذلك. تقول إن كثيرًا من العائلات شعرت بضغط كي <strong>تندمج</strong> مع الثقافة الجديدة. وتشرح أنه بسبب <strong>التمييز</strong> أخفى بعض الناس هويتهم الأصلية. وتقول: “في الماضي كان هناك وصمة لكونك أصليًا. لذلك لم تعترف عائلات كثيرة بذلك”.",
      t_c3_gateTitle: "السبب والنتيجة",
      t_c3_prompt:
        'يذكر النص وجود "وصمة لكونك أصليًا". ما النتيجة المباشرة لهذا الظلم والضغط نحو الاندماج؟',
      t_c3_a: "احتفلت الحكومة الأميركية بكل القبائل الأصلية المحلية واعترفت بها.",
      t_c3_b: "أدى ذلك إلى فترة سلام كبيرة واحتفالات ثقافية مشتركة للجميع.",
      t_c3_c: "اضطرت عائلات لينابية كثيرة إلى إخفاء تراثها لتجنب الإساءة.",
      t_c3_d: "بدأ المستوطنون الأوروبيون بارتداء اللباس التقليدي للينابي.",
      t_c4_title: "4) النُّصُب وقصة مانهاتن",
      t_c4_p1:
        "تذكر نُصُبان في نيويورك شعب اللينابي، لكن كليهما يروي قصة غير دقيقة تمامًا. يخلّد نُصُب في Battery Park ولوحة في Inwood Hill Park <strong>“بيع مانهاتن”</strong>، مما يواصل أسطورة يقول خبراء كثيرون إنها قصة ملفّقة.",
      t_c4_p2:
        "تدّعي اللوحة في Inwood Hill أن الصفقة حدثت هناك، مع أنها غالبًا أُبرمت في حصن أمستردام بجنوب مانهاتن. والأهم أن الخبراء يرون أن اللينابي اعتبروا الاتفاق <strong>تقاسمًا للأرض</strong> لا بيعًا دائمًا، بينما رآه الهولنديون بيعًا نهائيًا. تُظهر ملاحظات مجلس عام 1660 أن الهولنديين كانوا محبطين لأن اللينابي لم يغادروا. وردّ اللينابي بأنهم باعوا العشب فقط لا الأرض نفسها.",
      t_c4_gateTitle: "وجهة النظر",
      t_c4_prompt:
        "يصف النص خلافًا كبيرًا حول “بيع مانهاتن”. ما الفرق الأساسي بين وجهتَي نظر اللينابي والهولنديين؟",
      t_c4_a: "اتفق الطرفان على إعادة الأرض بعد بضع سنوات.",
      t_c4_b: "أراد اللينابي بيع الأرض بينما أراد الهولنديون استئجارها فقط.",
      t_c4_c: "رآه الهولنديون بيعًا واحدًا، بينما رآه اللينابي اتفاقًا على المشاركة.",
      t_c4_d: "كان الاتفاق متعلقًا بالفراء فقط ولا علاقة له بالأرض.",
      t_c5_title: "5) اللغة واستمرار الثقافة",
      t_c5_p1:
        "حتى لو روت النُّصُب قصة قديمة، تبقى ثقافة اللينابي حيّة اليوم. في أوكلاهوما، تستضيف قبيلة ديلاوير مخيمات للأطفال لتعلّم <strong>الممارسات الروحية اللينابيّة</strong> والأغاني والرقصات. كما عملوا جاهدين لإنقاذ لغة اللينابي المهددة بسبب قلّة المتحدثين بها بطلاقة.",
      t_c5_p2:
        "<strong>جيم ريمِنتر</strong> درس اللغة لأكثر من خمسين عامًا، وساعد في إنشاء <strong>قاموس لينابي الناطق</strong> الذي يقدّم دروسًا مع صوت عبر الإنترنت. ورغم عدم وجود متحدثين أصليين اليوم في أوكلاهوما، يقول إن الإقبال على التعلّم مستمر. ويوضح أن استخدام اللغة الأصلية في الصلوات والمراسم يصل الناس بثقافتهم وأسلافهم ويحافظ عليها قوية للأجيال القادمة.",
      t_c5_gateTitle: "الفكرة المركزية",
      t_c5_prompt:
        "رغم تهجيرهم من ديارهم، فقد بقيت ثقافة اللينابي. أي تفصيل يبرهن ذلك بشكل أفضل؟",
      t_c5_a: "تروي النُّصُب الحديثة في نيويورك تاريخ اللينابي كاملًا وبدقة.",
      t_c5_b: "أصبحت منطقة وول ستريت مركزًا ماليًا عالميًا مهمًا.",
      t_c5_c: "لم تعد مسارات اللينابي الأصلية ظاهرة في مانهاتن الحديثة.",
      t_c5_d: "تحافظ المخيمات الثقافية وقاموس لينابي الناطق على التقاليد واللغة.",
      t_refTitle: "انعكاس مهارات SEL واستجابة R.A.C.E.",
      t_refIntro1:
        "توقف قليلًا لتتصل بقصة اللينابي ومجتمعك. أجب باستخدام <strong>استراتيجية R.A.C.E.</strong>: أعد صياغة السؤال، ثم أجب بوضوح، ثم استشهد بدليل من المقال، ثم اشرح دلالته.",
      t_refPrompt:
        "السؤال: <em>كيف يؤثر تعلّمك عن صمود شعب اللينابي وحرصهم على أرضهم في طريقتك في دعم الآخرين والتعاطف معهم؟</em>",
      t_refFieldLabel: "اكتب فقرتك وفق R.A.C.E. (لا يُسمح باللصق):",
      t_typingOnly: "الكتابة فقط. تم تعطيل اللصق لضمان أن هذا من تفكيرك.",
      t_savedMsg: "يُحفَظ عملك على هذا الـ Chromebook حتى تضغط إرسال.",
      t_submitAll: "إرسال كل العمل",
      t_checkConn: "فحص الاتصال",
      t_raceRemindTitle: "تذكير سريع باستراتيجية R.A.C.E.",
      t_raceRemindP1:
        'ابدأ بـ <strong>جملة واحدة</strong> تعيد صياغة السؤال وتقدّم إجابتك. مثال: <em>"السؤال عن كيف يساعد العمل الجماعي صفنا، وهو يساعد لأننا نتقاسم المهام وندعم بعضنا".</em>',
      t_raceRemindP2:
        "بعد ذلك أدرج دليلًا من المقال واشرح كيف يتصل بتصرفاتك أو مشاعرك.",
      t_raceRubricTitle: "سلم تقييم فقرة R.A.C.E.",
      t_raceRubricIntro: "تحقق من كل بند لتجعل فقرتك مميزة.",
      t_r1: "<strong>إعادة الصياغة والإجابة:</strong> ابدأ بالسؤال بكلماتك وقدّم الإجابة بوضوح في الجملة نفسها.",
      t_r2: "<strong>الدليل:</strong> أدرج حقيقة محددة أو اقتباسًا من المقال.",
      t_r3: "<strong>الشرح:</strong> صِل الدليل بتجاربك أو مشاعرك أو تصرفاتك.",
      t_r4: "<strong>مهارات الكتابة:</strong> استخدم جملًا تامة وروابط واختتامًا إيجابيًا.",
      t_footer: "© مدرسة نورثسايد تشارتر الثانوية • الاستعداد لاختبار ريجنتس لتاريخ الولايات المتحدة",
      t_checkBtn_1: "تحقق", t_attemptsLabel_1: "المحاولات:",
      t_checkBtn_2: "تحقق", t_attemptsLabel_2: "المحاولات:",
      t_checkBtn_3: "تحقق", t_attemptsLabel_3: "المحاولات:",
      t_checkBtn_4: "تحقق", t_attemptsLabel_4: "المحاولات:",
      t_checkBtn_5: "تحقق", t_attemptsLabel_5: "المحاولات:"
    }
  };

  /* ========= apply translations ========= */
  function setLang(lang) {
    const map = I18N[lang] || I18N.en;
    // lang + direction
    document.documentElement.lang = lang;
    const isRTL = (lang === "ar");
    document.documentElement.dir = isRTL ? "rtl" : "ltr";

    // write all keys that exist on the page
    Object.entries(map).forEach(([id, value]) => {
      const el = document.getElementById(id);
      if (!el) return;
      // many strings contain <strong> etc, so use innerHTML
      el.innerHTML = value;
    });
  }

  /* ========= UI wiring ========= */
  (function initLangUI(){
    const select = document.getElementById("langSelect");
    if (!select) return;
    // default to English
    setLang("en");
    select.addEventListener("change", () => setLang(select.value));
  })();
  </script>
</body>
</html>
